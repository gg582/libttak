\doxysection{ntt.\+h}
\hypertarget{include_2ttak_2math_2ntt_8h_source}{}\label{include_2ttak_2math_2ntt_8h_source}\index{include/ttak/math/ntt.h@{include/ttak/math/ntt.h}}
\mbox{\hyperlink{include_2ttak_2math_2ntt_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00001}00001\ \textcolor{preprocessor}{\#ifndef\ TTAK\_MATH\_NTT\_H}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00002}00002\ \textcolor{preprocessor}{\#define\ TTAK\_MATH\_NTT\_H}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00004}00004\ \textcolor{preprocessor}{\#include\ <stddef.h>}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00005}00005\ \textcolor{preprocessor}{\#include\ <stdint.h>}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00006}00006\ \textcolor{preprocessor}{\#include\ <stdbool.h>}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00008}00008\ \textcolor{preprocessor}{\#if\ !defined(\_\_SIZEOF\_INT128\_\_)}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00009}00009\ \textcolor{preprocessor}{\#error\ "{}ttak\_ntt\ requires\ compiler\ support\ for\ \_\_int128"{}}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00010}00010\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00012}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a67323f7c611937893a2237faa187b351}{00012}}\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \_\_int128\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a67323f7c611937893a2237faa187b351}{ttak\_uint128\_native\_t}};}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00013}00013\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00014}00014\ \textcolor{comment}{/**}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00015}00015\ \textcolor{comment}{\ *\ @brief\ Predefined\ prime\ information\ for\ NTT\ operations.}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00016}00016\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00017}\mbox{\hyperlink{structttak__ntt__prime}{00017}}\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structttak__ntt__prime}{ttak\_ntt\_prime}}\ \{}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00018}\mbox{\hyperlink{structttak__ntt__prime_a854879b16fbf84c36a6e8e41b6db31e0}{00018}}\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{structttak__ntt__prime_a854879b16fbf84c36a6e8e41b6db31e0}{modulus}};\ \ \ \ \ \ \ \ \textcolor{comment}{/**<\ Prime\ modulus\ suitable\ for\ 2\string^k\ NTT.\ */}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00019}\mbox{\hyperlink{structttak__ntt__prime_a9b8cd05275c746fe6ed2a8a99492d36c}{00019}}\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{structttak__ntt__prime_a9b8cd05275c746fe6ed2a8a99492d36c}{primitive\_root}};\ \textcolor{comment}{/**<\ Primitive\ root\ of\ unity\ for\ the\ modulus.\ */}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00020}\mbox{\hyperlink{structttak__ntt__prime_ae5762556924dedb941fd3622d4780370}{00020}}\ \ \ \ \ uint32\_t\ \mbox{\hyperlink{structttak__ntt__prime_ae5762556924dedb941fd3622d4780370}{max\_power\_two}};\ \ \textcolor{comment}{/**<\ Maximum\ supported\ log2\ transform\ size.\ */}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00021}\mbox{\hyperlink{structttak__ntt__prime_af6b567c81813b57a6664f9c95fb59319}{00021}}\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{structttak__ntt__prime_af6b567c81813b57a6664f9c95fb59319}{montgomery\_inv}};\ \textcolor{comment}{/**<\ -\/mod\string^\{-\/1\}\ mod\ 2\string^64\ for\ Montgomery\ reduction.\ */}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00022}\mbox{\hyperlink{structttak__ntt__prime_aef021b4050093e70985ebbe2719b36d7}{00022}}\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{structttak__ntt__prime_aef021b4050093e70985ebbe2719b36d7}{montgomery\_r2}};\ \ \textcolor{comment}{/**<\ R\string^2\ mod\ modulus\ for\ Montgomery\ conversion.\ */}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00023}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_ae62e3373c925615a3883c0c6c0ad4ed2}{00023}}\ \}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_ae62e3373c925615a3883c0c6c0ad4ed2}{ttak\_ntt\_prime\_t}};}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00025}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a3d17fcf4b6668cff2d6f9a3e2efd8cfe}{00025}}\ \textcolor{preprocessor}{\#define\ TTAK\_NTT\_PRIME\_COUNT\ 3}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00027}00027\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_ae62e3373c925615a3883c0c6c0ad4ed2}{ttak\_ntt\_prime\_t}}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a08d9004f7979851e9e96fa6dc2ec982b}{ttak\_ntt\_primes}}[\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a3d17fcf4b6668cff2d6f9a3e2efd8cfe}{TTAK\_NTT\_PRIME\_COUNT}}];}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00028}00028\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00029}00029\ \textcolor{comment}{/**}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00030}00030\ \textcolor{comment}{\ *\ @brief\ Portable\ 128-\/bit\ container\ for\ CRT\ outputs.}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00031}00031\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00032}\mbox{\hyperlink{structttak__u128}{00032}}\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structttak__u128}{ttak\_u128}}\ \{}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00033}\mbox{\hyperlink{structttak__u128_a8558692f43c6e4b03cb023cb5fce086f}{00033}}\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{structttak__u128_a8558692f43c6e4b03cb023cb5fce086f}{lo}};}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00034}\mbox{\hyperlink{structttak__u128_ad49688250193b93cc07412d47d7faf53}{00034}}\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{structttak__u128_ad49688250193b93cc07412d47d7faf53}{hi}};}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00035}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_abfeb90537e89e74c3a5e0ac335194187}{00035}}\ \}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_abfeb90537e89e74c3a5e0ac335194187}{ttak\_u128\_t}};}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00037}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a721347613fb78eea89d768eccb29d145}{00037}}\ uint64\_t\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a721347613fb78eea89d768eccb29d145}{ttak\_mod\_add}}(uint64\_t\ a,\ uint64\_t\ b,\ uint64\_t\ mod);}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00038}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_aa690100cd8ebb7050f44abf055cfb678}{00038}}\ uint64\_t\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_aa690100cd8ebb7050f44abf055cfb678}{ttak\_mod\_sub}}(uint64\_t\ a,\ uint64\_t\ b,\ uint64\_t\ mod);}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00039}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a3d692168f7bd0997d122ba2cefe19261}{00039}}\ uint64\_t\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a3d692168f7bd0997d122ba2cefe19261}{ttak\_mod\_mul}}(uint64\_t\ a,\ uint64\_t\ b,\ uint64\_t\ mod);}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00040}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_afb422eba69e737d6bc6f63b62c83d570}{00040}}\ uint64\_t\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_afb422eba69e737d6bc6f63b62c83d570}{ttak\_mod\_pow}}(uint64\_t\ base,\ uint64\_t\ exp,\ uint64\_t\ mod);}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00041}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a2dbe59bb30c472b256471090bbb1e1da}{00041}}\ uint64\_t\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a2dbe59bb30c472b256471090bbb1e1da}{ttak\_mod\_inverse}}(uint64\_t\ value,\ uint64\_t\ mod);}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00043}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a3eacfaf694bbfb771b99ac41bd23a894}{00043}}\ uint64\_t\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a3eacfaf694bbfb771b99ac41bd23a894}{ttak\_montgomery\_reduce}}(\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a67323f7c611937893a2237faa187b351}{ttak\_uint128\_native\_t}}\ value,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_ae62e3373c925615a3883c0c6c0ad4ed2}{ttak\_ntt\_prime\_t}}\ *prime);}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00044}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_ac3dac3e8b60b32bfde3360432a71318e}{00044}}\ uint64\_t\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_ac3dac3e8b60b32bfde3360432a71318e}{ttak\_montgomery\_mul}}(uint64\_t\ lhs,\ uint64\_t\ rhs,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_ae62e3373c925615a3883c0c6c0ad4ed2}{ttak\_ntt\_prime\_t}}\ *prime);}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00045}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_ae3dc9c710e3c7c90784df382a1502795}{00045}}\ uint64\_t\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_ae3dc9c710e3c7c90784df382a1502795}{ttak\_montgomery\_convert}}(uint64\_t\ value,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_ae62e3373c925615a3883c0c6c0ad4ed2}{ttak\_ntt\_prime\_t}}\ *prime);}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00047}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a3372a84ab2ae3592b9f69d2389320880}{00047}}\ \_Bool\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a3372a84ab2ae3592b9f69d2389320880}{ttak\_ntt\_transform}}(uint64\_t\ *data,\ \textcolor{keywordtype}{size\_t}\ n,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_ae62e3373c925615a3883c0c6c0ad4ed2}{ttak\_ntt\_prime\_t}}\ *prime,\ \_Bool\ inverse);}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00048}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_aca4e392874373caf51b01fe0bd52a04f}{00048}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_aca4e392874373caf51b01fe0bd52a04f}{ttak\_ntt\_pointwise\_mul}}(uint64\_t\ *dst,\ \textcolor{keyword}{const}\ uint64\_t\ *lhs,\ \textcolor{keyword}{const}\ uint64\_t\ *rhs,\ \textcolor{keywordtype}{size\_t}\ n,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_ae62e3373c925615a3883c0c6c0ad4ed2}{ttak\_ntt\_prime\_t}}\ *prime);}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00049}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a5987151d8bbc95394224bfdf2ea2b0a9}{00049}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a5987151d8bbc95394224bfdf2ea2b0a9}{ttak\_ntt\_pointwise\_square}}(uint64\_t\ *dst,\ \textcolor{keyword}{const}\ uint64\_t\ *src,\ \textcolor{keywordtype}{size\_t}\ n,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_ae62e3373c925615a3883c0c6c0ad4ed2}{ttak\_ntt\_prime\_t}}\ *prime);}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00051}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a26f3bdf570043a69c628318d3ff96117}{00051}}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a26f3bdf570043a69c628318d3ff96117}{ttak\_next\_power\_of\_two}}(\textcolor{keywordtype}{size\_t}\ value);}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00053}\mbox{\hyperlink{structttak__crt__term}{00053}}\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structttak__crt__term}{ttak\_crt\_term}}\ \{}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00054}\mbox{\hyperlink{structttak__crt__term_a9df836d7d457731f3fd60cb4503350bc}{00054}}\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{structttak__crt__term_a9df836d7d457731f3fd60cb4503350bc}{residue}};}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00055}\mbox{\hyperlink{structttak__crt__term_aea1e8f16579f89002fb1fdb8b856bd34}{00055}}\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{structttak__crt__term_aea1e8f16579f89002fb1fdb8b856bd34}{modulus}};}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00056}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a1dc73a007834c1254aa8d4cb6f4eb296}{00056}}\ \}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a1dc73a007834c1254aa8d4cb6f4eb296}{ttak\_crt\_term\_t}};}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00058}\mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a5c01d8cc3142495ce988b8539d6a4d6b}{00058}}\ \_Bool\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a5c01d8cc3142495ce988b8539d6a4d6b}{ttak\_crt\_combine}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_a1dc73a007834c1254aa8d4cb6f4eb296}{ttak\_crt\_term\_t}}\ *terms,\ \textcolor{keywordtype}{size\_t}\ count,\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_abfeb90537e89e74c3a5e0ac335194187}{ttak\_u128\_t}}\ *residue\_out,\ \mbox{\hyperlink{include_2ttak_2math_2ntt_8h_abfeb90537e89e74c3a5e0ac335194187}{ttak\_u128\_t}}\ *modulus\_out);}
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00059}00059\ }
\DoxyCodeLine{\Hypertarget{include_2ttak_2math_2ntt_8h_source_l00060}00060\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ TTAK\_MATH\_NTT\_H}}

\end{DoxyCode}
